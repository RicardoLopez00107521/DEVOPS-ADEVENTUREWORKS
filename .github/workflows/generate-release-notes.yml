name: Generate Release Notes (AI Simulation)

on:
  workflow_dispatch:
  push:
    paths:
      - "**"   # detecta cualquier cambio en el repositorio

jobs:
  release-notes:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Simulate AI Release Notes
        id: ai_sim
        run: |
          echo "IA-SIMULATION: Analizando commits..."
          echo "IA-SIMULATION: Commit 1: Optimizaci√≥n del API."
          echo "IA-SIMULATION: Commit 2: Fix en m√≥dulo de facturaci√≥n."
          echo "IA-SIMULATION: Commit 3: Actualizaci√≥n de dependencias."
          echo "IA-SIMULATION: Clasificando cambios..."
          echo "IA-SIMULATION: Generando Release Notes simulados..."

          cat <<EOF > RELEASE_NOTES_v1.7.0.md
# üöÄ AdventureWorks ‚Äì Release Notes v1.7.0  
Generado autom√°ticamente por IA simulada (GitHub Actions)

## Mejoras
- Optimizaci√≥n del API de timbrado
- Mejora en tiempos de respuesta
- Ajuste de infraestructura

## Correcciones
- Fix en m√≥dulo de facturaci√≥n
- Manejo de errores 5xx

Responsable: Ricardo L√≥pez ‚Äì DevOps Engineer
Aprobado por: Ing. Mariana Herrera ‚Äì Jefa de Infraestructura
EOF

      - name: Commit release notes
        run: |
          mkdir -p release
          mv RELEASE_NOTES_v1.7.0.md release/

          git config --global user.name "CI Bot"
          git config --global user.email "cibot@example.com"

          git add release/RELEASE_NOTES_v1.7.0.md
          git commit -m "auto: generated release notes v1.7.0 (AI Simulation)" || echo "No changes to commit"

      - name: Upload artifact
        uses: actions/upload-artifact@v3
        with:
          name: release-notes
          path: release/RELEASE_NOTES_v1.7.0.md
